' Gambas class file

STATIC PRIVATE $sKey AS String

STATIC PUBLIC FUNCTION Run() AS String

  SELECT FPassword.ShowModal()
    CASE 1
      RETURN $sKey
    CASE 2
      RETURN "CONT"
  END SELECT

END

PUBLIC SUB btnOK_Click()

  $sKey = Trim(txtPassword.Text)
  IF Len($sKey) < 8 THEN
    Message(("Please enter at least eight characters."))
    RETURN
  ENDIF
  ME.Close(1)

END

PUBLIC SUB btnCancel_Click()

  ME.Close(2)

END

PUBLIC SUB btnQuit_Click()

  ME.Close

END

PUBLIC SUB Form_Open()

  'txtPassword.SetFocus  

END
