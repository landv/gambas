' Gambas class file

PUBLIC FUNCTION Run() AS Boolean

  RETURN NOT ME.ShowModal()

END


PUBLIC SUB btnCancel_Click()

  ME.Close

END

PUBLIC SUB btnOK_Click()

  DIM hServer AS CServer

  hServer = NEW CServer(Trim(LCase(cmbType.Text)), Trim(txtHost.Text), Trim(txtUser.Text), Trim(txtPassword.Text))

  ME.Close(TRUE)

CATCH

  Message.Error(Error.Text)

END

PUBLIC SUB cmbType_Click()

  DIM bVisible AS Boolean
  
  'bVisible = Upper(Left(cmbType.Text, Len("sqlite"))) = Upper("sqlite")
  bVisible = cmbType.Text LIKE "sqlite*"
  btnPath.Visible = bVisible
  panIdent.Visible = NOT bVisible
  
  IF bVisible THEN
    lblHost.Text = ("Path")
  ELSE
    lblHost.Text = ("Host")
  ENDIF

END

PUBLIC SUB btnPath_Click()

  DIM sPath AS String
  
  Dialog.Title = Subst(("Select a &1 database"), cmbType.Text)
  Dialog.Filter = []
  Dialog.Path = txtHost.Text
  IF Dialog.SelectDirectory() THEN RETURN
  sPath = Dialog.Path
  txtHost.Text = sPath

END

PUBLIC SUB Form_Open()

 IF txtUser.Text = "" THEN txtUser.Text = System.User.Name
 cmbType_Click()

END

