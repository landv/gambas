' Gambas class file

STATIC PRIVATE $iLine AS Integer

STATIC PUBLIC FUNCTION Run(iLine AS Integer) AS Integer

  DIM hForm AS FGotoLine

  $iLine = iLine
  hForm = NEW FGotoLine
  IF hForm.ShowModal() THEN RETURN $iLine

END

PUBLIC SUB Form_Open()

  txtLine.Text = CStr($iLine)
  txtLine.SelectAll
  txtLine.SetFocus

END

PUBLIC SUB btnOK_Click()

  TRY $iLine = Val(txtLine.Text)
  IF ERROR THEN RETURN

  ME.Close(TRUE)

END

PUBLIC SUB btnCancel_Click()

  ME.Close

END
