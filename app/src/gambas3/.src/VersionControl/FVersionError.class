' Gambas class file

Static Private $sText As String
Static Private $sDetail As String

Public Sub Run(sText As String, sDetail As String) 

  Dim iBusy As Integer
  
  $sText = sText
  $sDetail = Trim(sDetail)

  iBusy = Application.Busy
  Application.Busy = 0
  Me.ShowModal()
  Application.Busy = iBusy

End

Public Sub btnOK_Click()

  Me.Close

End

Public Sub Form_Open()

  Dim DS As Integer
  
  DS = Desktop.Scale
  
  lblError.Text = $sText
  
  If $sDetail Then 
  
    Project.SetEditorFont(txtDetail)
    txtDetail.Text = $sDetail
    panDetail.Show
    Me.H = panDetail.Y + panDetail.H + DS * 6
    
  Else
    
    Me.H = panDetail.Y + DS * 6
    panDetail.Hide
    
  Endif
  
End
