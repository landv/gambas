' Gambas class file

PUBLIC Name AS String
PUBLIC Type AS Integer
PUBLIC ReadOnly AS Boolean
PUBLIC Length AS Integer
PUBLIC Key AS Boolean
PUBLIC {Default} AS Variant

PUBLIC FUNCTION GetWidth(hCtrl AS Control) AS Integer

  DIM iWidth AS Integer
  DIM iLen AS Integer

  SELECT CASE Type

    CASE db.Boolean
      iWidth = hCtrl.Font.Width(Str(FALSE))

    CASE db.Integer
      iWidth = hCtrl.Font.Width("0") * 8

    CASE db.Long, db.Serial
      iWidth = hCtrl.Font.Width("0") * 16

    CASE db.Float
      iWidth = hCtrl.Font.Width("0") * 16

    CASE db.Date
      iWidth = hCtrl.Font.Width("00/00/0000 00:00:00")

    CASE db.String
      iLen = Length
      IF iLen = 0 THEN iLen = 255
      iLen = Min(32, iLen)
      iWidth = hCtrl.Font.Width("X") * iLen

  END SELECT

  iWidth = Max(iWidth, hCtrl.Font.Width(Name) + 16)

  RETURN iWidth

END


