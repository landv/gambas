' Gambas class file

Export

'Static Private $cMenu As New Collection

Static Public Sub _DefineShortcut(hParent As Menu)

  Dim hMenu As Menu
  Dim sText As String
  Dim cShortcut As New Collection
  Dim I As Integer
  Dim sCar As String
  Dim iPos As Integer
  'Dim hObs As Observer
  'Dim cText As Collection
  
  'Return
  
  For Each hMenu In hParent.Children
    
    sText = hMenu.Text
    If Not sText Then Continue
    
    iPos = String.InStr(sText, "&")
    If iPos Then 
      cShortcut[String.UCase(String.Mid$(sText, iPos + 1, 1))] = True
      Continue
    Endif
    
    For I = 1 To String.Len(sText)
      
      sCar = String.UCase(String.Mid$(sText, I, 1))
      
      If Len(sCar) = 1 And If Not IsLetter(sCar) And If Not IsDigit(sCar) Then Continue
      
      If Not cShortcut.Exist(sCar) Then
        
        ' If Not hObs Then
        '   hObs = New Observer(hParent) As "Menu"
        '   cText = New Collection
        '   '$cMenu[Object.Address(hParent)] = cText
        ' Endif
        
        hMenu.Text = String.Left(sText, I - 1) & "&" & String.Mid$(sText, I)
        hMenu._Text = sText
        cShortcut[sCar] = True
        
        Break
      Endif
    Next
    
    'If hMenu.Children.Count Then _DefineShortcut(hMenu)
    
  Next
  
End

' Static Public Sub Menu_Hide()
'   
'   Dim hParent As Menu = Last
'   Dim cText As Collection = $cMenu[Object.Address(Last)]
'   Dim hMenu As Menu
'   Dim sText As Variant
'   
'   If Not cText Then Return
'   
'   For Each hMenu In hParent.Children
'     
'     sText = cText[Object.Address(hMenu)]
'     If sText Then hMenu.Text = sText
'     
'   Next
'   
' End
