' Gambas class file

Public Sub SetIcon(sIcon As String)
  
  imgIcon.Image = "message" &/ sIcon & ".png"
  
End

Public Sub SetText(sText As String)
  
  txtMessage.Text = sText
  
End

Public Sub SetButton(sButton1 As String, Optional sButton2 As String, sButton3 As String)
  
  If sButton1 Then
    btnButton1.Text = sButton1
  Endif
  
  If sButton2 Then
    btnButton2.Text = sButton2
    btnButton2.Show
  Endif
  
  If sButton3 Then
    btnButton3.Text = sButton3
    btnButton3.Show
  Endif
  
End

Public Sub _new()

  Dim hCtrl As WebButton
  
  Me.Style["min-width"] = "24em"
  Me.Style["min-height"] = "12em"
  
  For Each hCtrl In [btnButton1, btnButton2, btnButton3]
    hCtrl.Style["min-width"] = "8em"
  Next
  
  imgIcon.Style["margin-right"] = "1em"

End

Private Sub HandleClick(iButton As Integer)

  Dim hForm As WebForm
  Dim sName As String

  hForm = WebControl.FromId(Me._Window).Form
  sName = Me["#message"]
  Object.Raise(hForm, "Message", [sName, iButton])
  Me.Close

End

Public Sub btnButton1_Click()

  HandleClick(0)

End

Public Sub btnButton2_Click()

  HandleClick(1)

End

Public Sub btnButton3_Click()

  HandleClick(2)

End
