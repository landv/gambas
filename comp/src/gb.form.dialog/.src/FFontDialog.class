' Gambas class file

Static Public FixedOnly As Boolean

Static Public Function SelectFont() As Boolean
  
  Return Not FFontDialog.ShowModal()

End


Public Sub btnOK_Click()

  If dlgFont.SelectedFont Then
    Dialog.Font = Font[dlgFont.SelectedFont]
  Else
    Dialog.Font = Null
  Endif
  Me.Close(True)

End

Public Sub btnCancel_Click()

  Me.Close

End

Public Sub Form_Open()

  Me.Title = Dialog.Title
  dlgFont.FixedOnly = FixedOnly

  If Component.IsLoaded("gb.settings") And If Dialog.Key Then
    Settings.Read(Me, "gb.form.dialog" &/ Dialog.Key)
  Endif

  If Dialog.Font Then
    dlgFont.SelectedFont = Dialog.Font.ToString()
  Else
    dlgFont.SelectedFont = Null
  Endif

End

Public Sub dlgFont_Activate()

  btnOK.Value = True

End

Public Sub Form_Close()

  If Component.IsLoaded("gb.settings") And If Dialog.Key Then
    Settings.Write(Me, "gb.form.dialog" &/ Dialog.Key)
  Endif

  Dialog.Key = ""

End
