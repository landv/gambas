' Gambas class file

Export

Event Change

Private $aStyle As TextEditorStyle[]

Public Sub _new()
  
  $aStyle = New TextEditorStyle[32]
  
  $aStyle[Highlight.Background] = New TextEditorStyle(Color.White) As "Style"
  $aStyle[Highlight.Normal] = New TextEditorStyle(Color.Black) As "Style"
  $aStyle[Highlight.Keyword] = New TextEditorStyle(Color.Black, True) As "Style"
  $aStyle[Highlight.Datatype] = New TextEditorStyle(&HDF6B00&, True) As "Style"
  $aStyle[Highlight.Function] = New TextEditorStyle(&H3398C3&, True) As "Style"
  $aStyle[Highlight.Operator] = New TextEditorStyle(Color.Black, True) As "Style"
  $aStyle[Highlight.Symbol] = New TextEditorStyle(Color.Black) As "Style"
  $aStyle[Highlight.Number] = New TextEditorStyle(&HFF0000&, True) As "Style"
  $aStyle[Highlight.String] = New TextEditorStyle(&H7F0000&) As "Style"
  $aStyle[Highlight.Comment] = New TextEditorStyle(&H888888&, False) As "Style"
  $aStyle[Highlight.Help] = New TextEditorStyle(&H888888&, True) As "Style"
  $aStyle[Highlight.Preprocessor] = New TextEditorStyle(&H006E28&, True) As "Style"
  $aStyle[Highlight.Breakpoint] = New TextEditorStyle(&HFF5F5F&) As "Style"
  $aStyle[Highlight.Current] = New TextEditorStyle(&H42C9FF&) As "Style"
  $aStyle[Highlight.Selection] = New TextEditorStyle(&HC3EDFF&) As "Style"
  $aStyle[Highlight.Highlight] = New TextEditorStyle(&H7FFF00&) As "Style"
  $aStyle[Highlight.CurrentLine] = New TextEditorStyle(&HE7F3FF&) As "Style"
  $aStyle[Highlight.Error] = New TextEditorStyle(&HBF0303&, False, True) As "Style"
  
End

Public Sub _GetStyles() As TextEditorStyle[]
  
  Return $aStyle
  
End


Public Sub _get((Style) As Integer) As TextEditorStyle

  Dim hStyle As TextEditorStyle
  
  Try hStyle = $aStyle[Style]
  If Error Then Error.Raise("Invalid argument")
  If Not hStyle Then
    With $aStyle[Highlight.Normal]
      hStyle = New TextEditorStyle(.Color, .Bold, .Underline, .Background)
      $aStyle[Style] = hStyle
    End With
  Endif
  
  Return hStyle
  
End

Public Sub Style_Change()
  
  Raise Change
  
End
