' Gambas class file

Private hChart As New Chart
Private hChart2 As New Chart
Public Sub Form_Open()
  
  IniChart2
  IniChart1
End


Private Sub IniChart1()

  hChart.Labels = ["Jan 14", "Fév", "Mar", "Avr", "Mai", "Jui", "Jui", "Aou", "Sep", "Oct", "Nov", "Déc"]
  hChart.Datas = [ChartDatas("Serie 1", [-16, -12, -6, -1, 5, 14, 29, 22, 13, 3, -6])] ', ChartDatas("Serie 2", [1.0, 2, 3, 4, 5, 3.5]), ChartDatas("Serie 3", [1.0, 2, 3, 4, 5, 3.5])]
  'hChart.Datas = [ChartDatas("Serie 1", [1.0, 2, 3, 4, 5, 6.5]), ChartDatas("Serie 2", [1.2, 2.3, 3.4, 4.5, 5.6, 3.5]), ChartDatas("Serie 3", [1.3, 2.4, 3.5, 4.6, 5.7, 3.5])]
  hChart.Border = True
  hChart.Colors = [Color.Orange]
  hChart.SetStyle("Bar")
  hChart.Legend.Position = Align.Right
  hChart.Legend.Visible = False
  hChart.Legend.Title = "Legend"
  hChart.Title.Text = "This is a temperature chart with minus values "
  hChart.Title.Font.Name = "Times"
  hChart.Title.Visible = True
  'AutoScale the fonts via an internal ratio like in a spreadsheet
  'so the chart always look good even if the device size change
  hChart.AutoScale = True
  hChart.Background = Color.Lighter(Color.Yellow)
  With hChart
    .Style!Y_MaxValue = 40
    .Style!Y_MinValue = -20
    'But :-)
    '.Style!Y_AutoScale = True
    .Style!Y_Step = 10
    .Style!X_Font = Font["Arial"]
    .Style!Y_Font = Font["Times,+2"]
    .Style!Padding = 10
    .Style!ShowValues = True
    .Style!Border = False
    .Style!ShowArrows = True
    .Style!ShowInterlines = True
    .Style!BarFont = Font["Times, 12"]
    .Style!BarWidth = 0.9
    .Style!BackGround = Color.Lighter(Color.Lighter(Color.Yellow))
    '.Style!Y_Pattern = "0.0"
    .Style!InterlinesColor = Color.Lighter(Color.blue)
    .Style!X_Label = "Activities since January 2014"
    .Style!Y_Label = "Temperature in ° Celcius"
  End With
  DrawingArea1.Refresh
End
Private Sub IniChart2()

  hChart2.Labels = ["Tic", "Tac", "Toe", "Titi", "Toto", "Tata"]
  'hChart.Datas = [ChartDatas("Serie 1", [-16, -12, -6, -1, 5, 14, 29, 22, 13, 3, -6])] ', ChartDatas("Serie 2", [1.0, 2, 3, 4, 5, 3.5]), ChartDatas("Serie 3", [1.0, 2, 3, 4, 5, 3.5])]
  hChart2.Datas = [ChartDatas("Serie 1", [1.0, 2, 3, 4, 5, 6.5]), ChartDatas("Serie 2", [1.2, 2.3, 3.4, 4.5, 5.6, 3.5]), ChartDatas("Serie 3", [1.3, 2.4, 3.5, 4.6, 5.7, 3.5])]
  'hChart.Border = True
  'hChart.Colors = [Color.Orange]
  hChart2.SetStyle("Bar")
  hChart2.Legend.Position = Align.Right
  hChart2.Legend.Visible = True
  hChart2.Legend.Title = "Legend"
  hChart2.Title.Text = "This is a multi series chart "
  hChart2.Title.Font.Name = "Times"
  hChart2.Title.Visible = True
  'AutoScale the fonts via an internal ratio like in a spreadsheet
  'so the chart always look good even if the device size change
  hChart2.AutoScale = True
  'hChart2.Background = Color.Lighter(Color.Yellow)
  With hChart2
    '.Style!Y_MaxValue = 8
    'Style!Y_MinValue = -2
    'But :-)
   .Style!Y_AutoScale = True
    .Style!Y_Step = 1
    .Style!X_Font = Font["Arial,+2"]
    .Style!Y_Font = Font["Times,+2"]
    .Style!Padding = 10
    '.Style!ShowValues = True
    .Style!Border = False
    .Style!ShowArrows = True
    '.Style!ShowInterlines = True
    .Style!BarFont = Font["Times, 12"]
    .Style!BarWidth = 0.9
    .Style!SeriesPadding = 1
    '.Style!BackGround = Color.Lighter(Color.Lighter(Color.Yellow))
    '.Style!Y_Pattern = "0.0"
    '.Style!InterlinesColor = Color.Lighter(Color.blue)
    '.Style!X_Label = "Activities since January 2014"
    '.Style!Y_Label = "Temperature in ° Celcius"
  End With
  DrawingArea1.Refresh
End

Public Sub DrawingArea1_Draw()

  hChart2.Paint(0, 0, Paint.Width, Paint.Height)
End

Public Sub DrawingArea2_Draw()

  hChart.Paint(0, 0, Paint.Width, Paint.Height)

End
