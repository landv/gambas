' Gambas class file

Export
''' The TestSuite class represents a suite of different tests to be run.  The TestSuite contains
''' a part-whole hierarchy of objects that implement the ITest interface --
''' including TestCase objects and other TestSuite objects.  Executing the Run method for the
''' TestSuite will execute all test cases that it contains.  The TestSuite class also provides
''' methods for add all test cases contained in a test container object into the suite.

Inherits ITest

Private $Tests As ITest[]

Public Sub _new()

    $Tests = New ITest[]

End Sub

Private Sub Class_Terminate()

    $Tests = Null

End Sub

'' Runs all tests contained within the collection and collects the result in the TestResult parameter.
Public Sub Run(oTestResult As TestResult)

    Dim oTest As ITest

    For Each oTest In $Tests
        Try oTest.Run(oTestResult)
        If Error Then
            oTestResult.AddError(Error.Code, Error.Where, Error.Text)
        Endif
    Next

End Sub

'' Number of test cases contained in the suite
Public Function CountTestCases() As Integer

    Return $Tests.Count

End Function

'' Add a object implementing ITest (either a TestCase or TestSuite) to the suite.
Public Sub AddTest(oTest As ITest)

    $Tests.Add(oTest)

End Sub

'' Add a TestCase to the suite.
Public Sub AddTestCase(oTestCase As ITestCase)

    $Tests.Add(oTestCase, Object.Class(oTestCase).Name)

End Sub

'' Create a new test case and add it to the suite.
Public Function AddNewTestCase(sName As String, oTestContainer As TestContainer)

    Dim test As TestCase

    test = New TestCase(sName, oTestContainer)
    $Tests.Add(test)

End

'' Create all test cases that are contained in the specified TestContainer and add them to the suite.
Public Function AddAllTestCases(oTestContainer As TestContainer)

    Dim sTests As Variant
    Dim i As Integer

    sTests = oTestContainer.TestCaseNames

    If sTests Then
        For i = 0 To sTests.Count - 1
            AddNewTestCase(CStr(sTests[i]), oTestContainer)
        Next
    Endif

End

'' Runs all tests contained within the collection and collects the result in a TestResult instance.

' Private Sub Run(oTestResult As TestResult)
'
'     run(oTestResult)
'
' End
