' Gambas class file

PRIVATE Game AS NEW CGameField


PRIVATE SUB DrawGame()
  
  Game.DrawGame(chkBorder.Value)
  
END


PUBLIC SUB Form_Open()
    Game.Init(chkSmall.Value, Slider2.Value)
    Game.SetDrawArea(dW)
    DrawGame
END

PUBLIC SUB Button1_Click()

    Game.Init(chkSmall.Value, Slider2.Value)
    Game.SetDrawArea(dW)
    DrawGame

END

PUBLIC SUB Button2_Click()

  tmrEvolution_Timer
  'Game.SpawnNextGeneration
  'DrawGame

END

PUBLIC SUB tmrEvolution_Timer()

  DIM Live AS Boolean[9]
  DIM Keep AS Boolean[9]

  IF NOT togEvolution.Value THEN RETURN
  
  live[0] = chkZero.Value = CheckBox.False
  live[1] = chkOne.Value = CheckBox.False
  live[2] = chkTwo.Value = CheckBox.False
  live[3] = chkThree.Value = CheckBox.False
  live[4] = chkFour.Value = CheckBox.False
  live[5] = chkFive.Value = CheckBox.False
  live[6] = chkSix.Value = CheckBox.False
  live[7] = chkSeven.Value = CheckBox.False
  live[8] = chkEight.Value = CheckBox.False
  
  keep[0] = chkZero.Value = CheckBox.None
  keep[1] = chkOne.Value = CheckBox.None
  keep[2] = chkTwo.Value = CheckBox.None
  keep[3] = chkThree.Value = CheckBox.None
  keep[4] = chkFour.Value = CheckBox.None
  keep[5] = chkFive.Value = CheckBox.None
  keep[6] = chkSix.Value = CheckBox.None
  keep[7] = chkSeven.Value = CheckBox.None
  keep[8] = chkEight.Value = CheckBox.None
  
  Game.SpawnNextGeneration(Live, Keep)
  DrawGame

END

PUBLIC SUB Slider1_Change()

  lblDelay.Caption = "Evolution Delay: " & Str(slider1.Value) & "ms"
  tmrEvolution.Delay = slider1.Value    

END

PUBLIC SUB chkBorder_Click()

  IF NOT togEvolution.Value THEN DrawGame

END

PUBLIC SUB togEvolution_Click()

  tmrEvolution.Enabled = togEvolution.Value

END

' PUBLIC SUB dW_Draw()
' 
'   Game.DrawGame(chkBorder.Value)
' 
' END
